<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
</head>
<body>

<style>
html,body{
    margin:0;
    width:100%; height:100%;
    background: black;
}
img{
  display:block;
  width:100%; height:100%;
  object-fit: cover;
}

video{
  display:block;
  width:100%; height:100%;
  object-fit: cover;
}

span{
  font-size: 21px;
	color: white;
	position: absolute;
	left: 1.5%;
	transform: rotate(0deg);
	bottom: 1.5%;
}

</style>

<div id="mainimage">mainimage: undefined</div>
<span id="subline">subline: undefined</span>

<script>
function WaitFor(time) {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve('-');
    }, time);
  });
}

var targetJSON = '.../json.php'
var targetIMG = 'upload_img/'
var targetVID = 'upload_img/'

async function asyncCall(){
  const response = await fetch(targetJSON);
  const mainJSON = await response.json();  
  console.log(mainJSON);
  var reload = 0;
  while (reload < 20) {
		var i = 0;
		while (i < mainJSON.length) {
			console.log(i, mainJSON[i]);		
			if (mainJSON[i][2].slice(-3) == "jpg" ||  mainJSON[i][2].slice(-3) == "png") {
				console.log("jpg");
				document.getElementById("mainimage").outerHTML = '<img id="mainimage" src="'+targetIMG+mainJSON[i][2]+'" alt="-">';
			} else if (mainJSON[i][2].slice(-3) == "mp4") {
				console.log("mp4");
				document.getElementById("mainimage").outerHTML = '<video id="mainimage" autoplay><source src="'+targetVID+mainJSON[i][2]+'" type="video/mp4">not support</video>'
			} else {
				console.log("not a valid file-format");
				document.getElementById("mainimage").outerHTML = '<p id="mainimage">not a valid file-format</p>'
			}
			
			document.getElementById("subline").outerHTML = '<span id="subline">'+mainJSON[i][1]+'</span>';
			await WaitFor(1000*mainJSON[i][3]+1);
			console.log("end: "+i); 
			i++;
		} console.log("end mainJSON"); 
	} location.reload(); 
};

asyncCall();

</script>

</body>
</html>
